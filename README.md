# HuYanSession 壶言会话———自定义回复和小群管插件


![](https://img.shields.io/badge/插件类型-Console-%2355db30?style=flat-square)  [![GitHub release (latest by date)](https://img.shields.io/github/v/release/Moyuyanli/HuYanSession?style=flat-square)](https://github.com/Moyuyanli/HuYanSession/releases)  [![GitHub release (latest by date including pre-releases)](https://img.shields.io/github/downloads-pre/Moyuyanli/HuYanSession/1.9.19-Bate/total?style=flat-square)](https://github.com/Moyuyanli/HuYanSession/releases/download/1.9.19-Bate/HuYanSession-1.9.19-Bate.mirai2.jar)   ![GitHub top language](https://img.shields.io/github/languages/top/Moyuyanli/HuYanSession?style=flat-square)   [![](https://img.shields.io/badge/MiraiForum-%E5%A3%B6%E8%A8%80%E4%BC%9A%E8%AF%9D-%23478cc6?style=flat-square)](https://mirai.mamoe.net/topic/1310/%E5%A3%B6%E8%A8%80-%E4%B8%80%E6%AC%BE%E5%90%84%E7%A7%8D%E8%87%AA%E5%AE%9A%E4%B9%89%E5%9B%9E%E5%A4%8D%E6%B6%88%E6%81%AF%E6%8F%92%E4%BB%B6)

---

### 使用

丢进plugin文件夹中运行console就行
运行一次之后停掉console，到config里面设置一下主人和指定机器人

---
### 基本功能

#### 学习指令

根据关键词进行特定形式的回复
学习指令的基本格式

    学习 (触发内容) (回复内容) [精准|模糊|头部|结尾] [当前|群组{编号}|全局]
    例： 学习 啊 吧

后面两个参数是可选，不带就是默认第一个

+=[后续可能会简化学习指令的格式为xx]=+

---
### 关键词参数意义

可以指定关键词匹配方式，以及作用域范围

指定匹配方式：
目前有4中匹配方式

* 精准：一模一样才能触发
* 模糊：只要消息内包含关键词就能触发
* 头部：消息最前面的内容相同就能触发
* 结尾：消息结尾的内容相同就能触发

当你学习了一个模糊匹配的关键词

    学习 怎么办 凉拌咯~ 模糊

在遇见消息内包含'怎么办'就会触发

![58d4fce4-e60f-45ad-8171-c2aed424f686-图片.png](/assets/uploads/files/1655710081100-58d4fce4-e60f-45ad-8171-c2aed424f686-图片.png) ![img.png](img.png)

其他匹配机制同理

指定作用范围，目前有三种形式：

* 当前：在群内学习的消息回复不携带参数会默认为当前群触发
* 群组{编号}：设定为你指定的多个群触发
* 全局：所有群都能触发

如果不填，默认只在本群触发。
添加全局的话只能是主人才能添加！

    学习 啊 巴~ 结尾 群组2
    学习 乒 乓 全局

---
### 查询和删除

    查询 [关键内容]

    删除 (关键内容)

查询可以查询全部，也可以查询单条信息

---
### 多词条消息
特别设定了一个关键词触发多条回复消息的功能。

    学习多词条 触发内容 回复内容1 [精准|模糊|头部|结尾] [当前|群组{编号}|全局] [轮询|随机]

当第一次学习多词条时，会新建一条多词条消息，后续学习多词条都只会进行添加回复内容，不会更改参数

    学习多词条 触发内容 回复内容2

也有便利的多词条添加功能

    添加多词条 触发内容


然后就可以分条发送你需要添加的内容了。
有一个容错机制，发送'！'删除上一条触发内容。
需要完成添加只需要发送'！！！'，即可结束添加，将内容保存到
该条多词条回复中。

多词条回复的查询跟回复消息的查询一样。
但是删除可以有两种情况

    删除多词条 触发内容 回复内容

这样的删除可以删除该条多词条回复中的某一个回复内容。
需要删除整个多词条跟消息回复的删除一样

    删除 触发内容


---
### 群组操作

由于机器人拥有的群属于个人隐私
因此该指令只能由主人跟机器人私发

    +gr：(群组编号) (群号1) [群号2] ...

群号可以一次添加多个，也可以一次就只加一个，然后继续添加。
-gr：(群组编号) [群号]
删除也是处于两种状态->
一种只填写群组编号，直接删除该群组
一种填写群组编号和群号，删除指定群组下的指定群号

    gr：   #查看

---
### 权限操作

内部携带一个简单的权限系统，可以让部分指令的权限外放

操作指令

    +@某人 (session|admin|group|all)
    -@某人 (session|admin|group|all)

* session 会话权限 也就是学习 删除 查询 3大指令的使用权
* admin 管理权限 可以操作权限的人，意思他也可以操作别人的权限(只有这个权限的话也是用不了会话仨指令的,虽然能给自己加就是)
* group 群管理权限 群管操作的指令权限
* all 上面3个权限

---
### 群管理操作

#### 欢迎新人

默认有个欢迎词，如果不自定义添加的话。

    +hyc:(tag)  (内容) [群组{编号}]  #添加
    -hyc：(tag)  #删除
    hyc:  #查看欢迎词


支持图片，支持多条消息，每次加人会随机获取一条发送。

默认无检测群。
需要用指令添加qq群来实现检测

        /hy addgroup <群号> #添加
        /hy delgroup <群号> #删除

也可以去config里面手动添加

#### 解禁言

对于禁言，设立了超级便捷的识别法

        @某人 3s  #禁言3秒
        @某人 5m  #禁言5分钟


其他的时间单位还有h(小时),d(天)。
解除禁言只需要吧时间改为0s就可以了。

记得给机器加管理哦~

同时，该指令支持权限操作，也就是拥有group权限的群友同样可以使用。

#### 踢人

    踢人@某人

---
### 定时任务(测试中)

最新开发的功能，可以按照需求添加定时任务+=[虽然叫任务，但是目前只支持发送消息]=+。

用主人号给机器私发消息即可

    %ds  #添加定时任务

注意，目前还不能删除，但是可以关闭，所以别加太多。
然后照着提示一步一步发送就行。


对于定时器名称，~~目前~~不支持中文。
对于定时频率,目前不支持中文识别+=[在做了在做了...]=+
只识别cron表达式，不懂的请务必花5分钟了解一下

输入格式

    $cron(表达式)

这个是为定时任务设置的一个参数识别，后续可能还会有http之类的。

定时任务添加完成后默认关闭，可以查看

    ds: #查看定时任务
    +ds:(id) #开启定时任务
    -ds:(id)  #关闭定时任务

---
### 其他操作

刚进社区就接触了个[斗地主插件](https://mirai.mamoe.net/topic/626/%E6%96%97%E5%9C%B0%E4%B8%BB-%E4%B8%80%E4%B8%AA%E5%9C%A8qq%E7%BE%A4%E5%86%85%E6%96%97%E5%9C%B0%E4%B8%BB%E7%9A%84%E6%8F%92%E4%BB%B6-%E6%9C%89%E7%BC%96%E8%AF%91),所以玩了好久。
甚至后来拿到源码根据自身的需求进行了一番修改，然后继续用着，但是没有帮助，就顺手在本插件里面写了一个改过后的斗地主插件的帮助...


    欢迎查看斗地主帮助!
    在有权限的群内发送'开桌'即可创建斗地主对局.
    需求自定义底分的对局可发送'开桌 [底分]'即
    可创建自定义底分对局.
    对局创建后，发送'上桌'即可上桌，当人满3人就
    可以发送'发牌'让机器人给你们发牌.
    在对局未开始之前上桌可以发送'下桌'下桌.
    游戏开始后进入抢地主，可发送'抢','抢地主'
    或'不抢'进行地主的博弈.
    进入出牌阶段，发送'！[牌]'即可出牌.
    当你要不起时可以发送'过','要不起','不要'来跳过.
    在任何阶段，管理员可以发送'掀桌'结束对局.
    指令帮助.
    #d beg 领取每日500豆
    #d me 查看胜率
    #da add qq point 为qq添加point个豆子
    #dc addamin qq 添加游戏管理员
    #dc addgroup qq群号  添加游戏群
    以上就是斗地主帮助，祝你游戏愉快!


发送斗地主就可

    斗地主

想要我这个[斗地主改版](https://github.com/Moyuyanli/HuYanSession/releases/tag/Dou)也可以来找我要或者进群里要。
这个默认是关闭的，可以按需求开启。

发送帮助即可获取本插件的基本帮助
默认不在群里显示，可以在config里面开启群内显示(方便与群友学习)
查看所有帮助需要在发送帮助后面发送详细帮助

    帮助

    详细帮助

帮助里面有个本帖子的链接地址，但是默认不显示，可以到config里面开启。
因为所有更新优先填写到这边，其他位置可能稍微慢点。


有几个指令，只有console的主人才有权限使用


    /hy pu 对喷
  
    /hy power <s> <qq> <power> 根据qq号进行权限更改，第一个参数就是+或者-
   
---
### 已知BUG和规划
-规划:~~已更新多词条回复功能~~->1.6.5
-更新:~~更新学习匹配机制~~->1.6.7
-更新:~~更改配置文件~~->1.6.8
-bug:~~修复了禁言失败报错的bug~~->1.6.10
-规划:~~多词条批量添加~~->1.7.12
-规划:~~自定义定时回复~~ ->1.8.12
-规划:~~实现消息分组设置~~ ->1.9.12
-规划:自定义关键词禁言
-规划:多次发送消息类型学习方法(方便设置菜单)
-规划:更便捷的学习指令


---
### 意见与反馈

如果你有更好的意见或者发现了某个bug，欢迎在下方评论

---
### 推荐

进了一个[Mirai的交流群](https://mirai.mamoe.net/topic/1293/%E6%88%91%E5%BB%BA%E4%BA%86%E4%B8%80%E4%B8%AAmirai%E7%9A%84qq%E7%BE%A4-%E9%9D%9E%E5%AE%98%E6%96%B9)
欢迎大家也进来玩啊~